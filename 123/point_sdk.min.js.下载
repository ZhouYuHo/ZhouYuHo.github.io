(function(){if(!(window.document&&window.document.body&&"getAttribute"in window.document.body)){return false}var config={website:"",request_url:"/sdknew/img",request_mime_type:'png',screen:"0*0",referrer:"",url:"",uri:"",uid1:"",uid2:"",target:"",event_type:"",event_info:"",position:"0*0",gain_attr:"data-sea",bind_attr:"data-sa",mod_attr:"data-smod",target_attr:"data-starget",info_attr:"data-sinfo",name_attr:"data-sname",event_attr:"data-sevent",version:"3.1",queue:[],pp:function(){},pu:function(){}};var Params;(function(){config.url=getUrl();config.referrer=getReferrer();config.uuid=getUuid();config.uri=getUri();config.page=getPage();config.source=getSource();window._mxs=config;Params=(function(){var url=escape(config.url),uri=config.uri,referrer=escape(config.referrer),uuid=config.uuid,page=config.page,source=config.source;return function(){return{url:url,referrer:referrer,uri:uri,page:page,source:source,uuid:uuid,prev_id:"",curt_id:"",search:"",target:"",event_type:"",event_info:"",name_id:"",event:"",position:""}}})();(function(){var queue=[];window._mxs.pp=function(self){nodePush(self,{})};window._mxs.pu=function(action,target,info_text,position_event,uid1,uid2,sea,name){if(!action){action=""}if(!target){target=""}if(!info_text){info_text=""}if(!position_event){position_event={pageX:0,pageY:0}}if(!uid1){uid1=""}if(!uid2){uid2=""}if(!sea){sea=""}if(!name){name=""}var info=dealInfo_text(info_text);_mxs.queue.push(getParams(action,gainid1(uid1),gainid2(uid2),gain_sea(sea),search(sea),target,getEventPosition(position_event),info,name))};Object.defineProperty(_mxs,'queue',{configurable:true,enumerable:true,get:function(){return queue},set:setQueue});(function(arr,method){var org_method=Array.prototype[method];arr[method]=function(){org_method.apply(arr,arguments);dealQueue(arr);return arr}})(queue,'push');function setQueue(val){queue=val;dealQueue(queue)}window.addEventListener('load',function(){queue.push(getParams("","","","",getCookie("uid1"),getCookie("uid2"),"",""))})})()})();(function(){function getSource(){var sUserAgent=navigator.userAgent.toLowerCase();var bIsIpad=sUserAgent.match(/ipad/i)=="ipad";var bIsIphoneOs=sUserAgent.match(/iphone os/i)=="iphone os";var bIsMidp=sUserAgent.match(/midp/i)=="midp";var bIsUc7=sUserAgent.match(/rv:1.2.3.4/i)=="rv:1.2.3.4";var bIsUc=sUserAgent.match(/ucweb/i)=="ucweb";var bIsAndroid=sUserAgent.match(/android/i)=="android";var bIsCE=sUserAgent.match(/windows ce/i)=="windows ce";var bIsWM=sUserAgent.match(/windows mobile/i)=="windows mobile";if(bIsIpad||bIsIphoneOs||bIsMidp||bIsUc7||bIsUc||bIsAndroid||bIsCE||bIsWM){return "wap"}else{return "pc"}}var port=getSource();if(port=="wap"){var isPageHide=false;window.addEventListener('pageshow',function(){if(isPageHide){window.location.reload()}});window.addEventListener('pagehide',function(){isPageHide=true});var u=navigator.userAgent;var bIsAndroid=u.indexOf('Android')>-1||u.indexOf('Linux')>-1;if(bIsAndroid){var bind_event='click'}else{var bind_event='touchstart'}}else{var bind_event='click'}window.addEventListener(bind_event,function(e){var t=e.target;while(!(t&&t.getAttribute&&t.getAttribute(config.bind_attr))){if(!t){break}t=t.parentNode}clickId(e);if(t&&t.getAttribute&&t.getAttribute(config.bind_attr)){nodePush(t,e)}})})();function nodePush(t,e){var bind_a=config.bind_attr,target_a=config.target_attr,info_a=config.info_attr,name_a=config.name_attr,event_a=config.event_attr,info={};if(t&&t.getAttribute&&t.getAttribute(bind_a)){var info_text="",name_text="",event_text="",target_text="";if(!(name_text=t.getAttribute(name_a))){name_text=""}if(!(event_text=t.getAttribute(event_a))){event_text=""}if(!(target_text=t.getAttribute(target_a))){target_text=""}if((info_text=t.getAttribute(info_a))&&typeof info_text=='string'){info=dealInfo_text(info_text)}_mxs.queue.push(getParams(t.getAttribute(bind_a),target_text,getEventPosition(e),info,gainid1(e),gainid2(e),gain_sea(e),name_text,event_text))}}function dealInfo_text(info_text){var info={};info_text=info_text.replace(/\'/g,"\"").replace(/\s/g,"");info_text=info_text.indexOf('json')>-1?info_text.split("|"):info_text;info=(typeof info_text=='string')?info_text:info_text[1];return info}function getParams(event_type,target,position,event_info,prev_id,curt_id,search,name_id,event){if(!event_type){event_type="refresh"}if(!target){target=""}if(!position){position="[0,0]"}if(!event_info){event_info=""}if(!search){search=""}if(!name_id){name_id=""}if(!event){event=""}if(typeof event_info=='object'){event_info=JSON.stringify(event_info)}var np=new Params();np.event_type=event_type;np.target=target;np.position=position;np.event_info=event_info;np.prev_id=prev_id;np.curt_id=curt_id;np.search=search;np.name_id=name_id;np.event=event;return np}function getUri(){var uri=window.document.location.pathname;return uri}function GetQueryString(name){var reg=new RegExp("(^|&)"+name+"=([^&]*)(&|$)");var r=window.location.search.substr(1).match(reg);if(r!=null){return unescape(r[2])}return null}function getPage(){var page=GetQueryString("p");if(page==undefined){return ""}else{return page}}function GetCookieValue(name){var cookieValue=null;if(document.cookie&&document.cookie!=''){var cookies=document.cookie.split(';');for(var i=0;i<cookies.length;i+=1){var cookie=cookies[i].replace(/(^\s*)|(\s*$)/g,"");if(cookie.substring(0,name.length+1)==(name+'=')){cookieValue=decodeURIComponent(cookie.substring(name.length+1));break}}}return cookieValue}function getSource(){var sUserAgent=navigator.userAgent.toLowerCase();var bIsIpad=sUserAgent.match(/ipad/i)=="ipad";var bIsIphoneOs=sUserAgent.match(/iphone os/i)=="iphone os";var bIsMidp=sUserAgent.match(/midp/i)=="midp";var bIsUc7=sUserAgent.match(/rv:1.2.3.4/i)=="rv:1.2.3.4";var bIsUc=sUserAgent.match(/ucweb/i)=="ucweb";var bIsAndroid=sUserAgent.match(/android/i)=="android";var bIsCE=sUserAgent.match(/windows ce/i)=="windows ce";var bIsWM=sUserAgent.match(/windows mobile/i)=="windows mobile";if(bIsIpad||bIsIphoneOs||bIsMidp||bIsUc7||bIsUc||bIsAndroid||bIsCE||bIsWM){return "wap"}else{return "pc"}}function DelCookie(name){var exp=new Date();exp.setTime(exp.getTime()+(-1*24*60*60*1000));var cval=GetCookieValue(name);document.cookie=name+"="+cval+"; expires="+exp.toGMTString()}function getCookie(name){var arr,reg=new RegExp("(^| )"+name+"=([^;]*)(;|$)");return(arr=document.cookie.match(reg))?unescape(arr[2]):null};function gainid1(event){event=getCookie("uid1");return event}function gainid2(event){event=getCookie("uid2");return event}function gain_sea(event){event=getCookie("search");var vv="";document.cookie="search="+vv+";path=/";return event}function getUuid(){var uid=document.cookie.indexOf("uuid=");if(uid==-1){var d=new Date().getTime();var vid='xxxxxxxx-xxxx-xxxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g,function(c){var r=(d+Math.random()*16)%16|0;d=Math.floor(d/16);return(c=='x'?r:(r&0x3|0x8)).toString(16)});document.cookie="uuid="+vid+";path=/";return vid}else{var uuid=getCookie("uuid");return uuid}}function clickId(e){var g=e.target;if($(g).attr("data-sa")==undefined&&$(g).parents("[data-sa]").attr("data-sa")==undefined){return false}else{var d=new Date().getTime();var uid4='xxxxxxxx-xxxx-xxxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g,function(c){var r=(d+Math.random()*16)%16|0;d=Math.floor(d/16);return(c=='x'?r:(r&0x3|0x8)).toString(16)});if($(g).attr("data-simg")==undefined){if($(g).parents("[data-simg]").attr("data-simg")==undefined){var dd=getCookie("uid2");document.cookie="uid1="+dd+";path=/";document.cookie="uid2="+uid4+";path=/"}else{var fff=$(g).parents("[data-simg]").attr("data-simg");var string_a=fff.replace("?","");var string=string_a.split('&');var res={};for(var i=0;i<string.length;i+=1){var str=string[i].split('=');res[str[0]]=str[1]}var ttt=JSON.stringify(res);var logdata=JSON.parse(ttt);var olduid1=logdata.prev_id;var newuid1=logdata.curt_id;document.cookie="uid1="+newuid1+";path=/";document.cookie="uid2="+uid4+";path=/"}}else{var fff=$(g).attr("data-simg");var string_a=fff.replace("?","");var string=string_a.split('&');var res={};for(var i=0;i<string.length;i+=1){var str=string[i].split('=');res[str[0]]=str[1]}var ttt=JSON.stringify(res);var logdata=JSON.parse(ttt);var olduid1=logdata.prev_id;var newuid1=logdata.curt_id;document.cookie="uid1="+newuid1+";path=/";document.cookie="uid2="+uid4+";path=/"}}}function getReferrer(){if(document){return document.referrer||""}return ""}function getUrl(){if(window.location){return window.location.href}if(document.location){return document.location.href}return ""}function getEventPosition(event){var x=0,y=0;if(event.pageX!=undefined&&event.pageY!=undefined){x=event.pageX;y=event.pageY}return JSON.stringify([x,y])}function filterByAttr(dom_list,attr){var l=dom_list.length,d;for(var i=0;i<l;i+=1){d=dom_list[i];if(d&&d.getAttribute&&d.getAttribute(attr)){return[d,d.getAttribute(attr)]}}}function dealQueue(arr){if(arr.length<1){return}if('length'in arr[0]){arr[0]=window._mxs[arr[0][0]].apply({},arr[0][1]);return}sendRequest(arr[0],function(){arr.shift();dealQueue(arr)},function(){arr.shift();dealQueue(arr)})}function getNowFormatDate(){var date=new Date();var seperator1="-";var seperator2=":";var month=date.getMonth()+1;var strDate=date.getDate();if(month>=1&&month<=9){month="0"+month}if(strDate>=0&&strDate<=9){strDate="0"+strDate}var currentdate=date.getFullYear()+seperator1+month+seperator1+strDate+" "+date.getHours()+seperator2+date.getMinutes()+seperator2+date.getSeconds();return currentdate}function sendRequest(params,callback,onerror){var img=new Image(1,1);var after_text="?";var method='post';for(var i in params){if(after_text!="?"){after_text+="&&"}after_text+=(""+i+"=="+params[i])}if(params['event']==='ad_click'){method='get'}after_text+=("&&build_time=="+new Date().getTime());if(typeof callback=='function'){img.onload=callback}if(typeof onerror=='function'){img.onerror=onerror}img.src=window._mxs.request_url+"/"+window._mxs.website+"."+window._mxs.request_mime_type+after_text;var string_a=after_text.replace("?","");var string=string_a.split('&&');var res={};for(var i=0;i<string.length;i+=1){var str=string[i].split('==');res[str[0]]=str[1]}var ttt=JSON.stringify(res);var logdata=JSON.parse(ttt);if($("#sswitch").length>0){var sval=$("#sswitch").val();if(sval==1){$.ajax({type:method,url:"/user/action",data:logdata})}}else{return false}}})();